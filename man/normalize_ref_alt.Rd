% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/prepro-accepted-ref-alt.R
\name{normalize_ref_alt}
\alias{normalize_ref_alt}
\title{Normalize REF and ALT to standard VCF conventions}
\usage{
normalize_ref_alt(chr, pos, ref, alt, mutation_type, fasta)
}
\arguments{
\item{chr}{A character string specifying the chromosome name "chr1".}

\item{pos}{An integer specifying the position of the mutation (1-based).}

\item{ref}{A character string specifying the reference allele (can be empty for some formats).}

\item{alt}{A character string specifying the alternate allele (can be empty for some formats).}

\item{mutation_type}{A character string indicating the type of mutation.
Valid values include: "SNV", "MNV", "insertion", "deletion".}

\item{fasta}{An object or path to a FASTA file. You may need to adapt the code inside
to properly retrieve the reference base (using {Biostrings::getSeq} or another method).}
}
\value{
A character vector of length 2, c(new_ref, new_alt), containing the normalized reference and alternate alleles.
}
\description{
This function normalizes REF and ALT alleles to the standard VCF conventions.
It handles both the common VCF-like formats (SNV, MNV, insertion, deletion)
and also the alternate insertion/deletion formats where ref or alt might be empty.
}
\details{
For SNV or MNV, usually no change is required.
For an insertion, the final REF should have a length of 1 (the anchor base),
and ALT should have length at least of 2
For a deletion, the final ALT should have a length of 1 (the anchor base),
and REF should have length at least of 2

If ref or alt is empty (depending on whether it is an insertion or deletion),
the function will fetch the anchoring base from the fasta at position pos,
which is assumed to be the coordinate immediately before the indel in standard VCF conventions.
After ensuring one shared base (the anchor), the function trims any remaining common prefix
so that only the first nucleotide remains the same on both ref and alt.
}
\examples{
Example: normalizing an insertion where ref is empty and alt is "TC"
Position 3 is assumed to be the base before the actual insertion.
Suppose the anchor base in FASTA at position 3 is "C".

c(new_ref, new_alt) <- normalize_ref_alt(
  pos = 3,
  ref = "",
  alt = "TC",
  mutation_type = "insertion",
  fasta = "path/to/genome.fasta"
)
Result might be new_ref = "C", new_alt = "CTC" (depending on trimming).

}
